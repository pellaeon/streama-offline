//# sourceMappingURL=angular-local-storage.js.map
/*
 MIT License, http://www.opensource.org/licenses/MIT
*/
(function(J,g){var F=g.isDefined,A=g.isUndefined,G=g.isNumber,v=g.isObject,H=g.isArray,I=g.extend,B=g.toJson;g.module("LocalStorageModule",[]).provider("localStorageService",function(){this.prefix="ls";this.storageType="localStorage";this.cookie={expiry:30,path:"/"};this.notify={setItem:!0,removeItem:!1};this.setPrefix=function(c){this.prefix=c;return this};this.setStorageType=function(c){this.storageType=c;return this};this.setStorageCookie=function(c,p){this.cookie.expiry=c;this.cookie.path=p;return this};
this.setStorageCookieDomain=function(c){this.cookie.domain=c;return this};this.setNotify=function(c,p){this.notify={setItem:c,removeItem:p};return this};this.$get=["$rootScope","$window","$document","$parse",function(c,p,h,g){var k=this,d=k.prefix,r=k.cookie,w=k.notify,q=k.storageType,l;h?h[0]&&(h=h[0]):h=document;"."!==d.substr(-1)&&(d=d?d+".":"");var n=function(){try{var a=q in p&&null!==p[q],b=d+("__"+Math.round(1E7*Math.random()));a&&(l=p[q],l.setItem(b,""),l.removeItem(b));return a}catch(f){return q=
"cookie",c.$broadcast("LocalStorageModule.notification.error",f.message),!1}}(),y=function(a,b){b=A(b)?null:B(b);if(!n||"cookie"===k.storageType)return n||c.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),w.setItem&&c.$broadcast("LocalStorageModule.notification.setitem",{key:a,newvalue:b,storageType:"cookie"}),t(a,b);try{l&&l.setItem(d+a,b),w.setItem&&c.$broadcast("LocalStorageModule.notification.setitem",{key:a,newvalue:b,storageType:k.storageType})}catch(f){return c.$broadcast("LocalStorageModule.notification.error",
f.message),t(a,b)}return!0},D=function(a){if(!n||"cookie"===k.storageType)return n||c.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),C(a);a=l?l.getItem(d+a):null;if(!a||"null"===a)return null;try{return JSON.parse(a)}catch(b){return a}},E=function(){var a,b;for(a=0;a<arguments.length;a++)if(b=arguments[a],n&&"cookie"!==k.storageType)try{l.removeItem(d+b),w.removeItem&&c.$broadcast("LocalStorageModule.notification.removeitem",{key:b,storageType:k.storageType})}catch(f){c.$broadcast("LocalStorageModule.notification.error",
f.message),x(b)}else n||c.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),w.removeItem&&c.$broadcast("LocalStorageModule.notification.removeitem",{key:b,storageType:"cookie"}),x(b)},u;try{u=p.navigator.cookieEnabled||"cookie"in h&&(0<h.cookie.length||-1<(h.cookie="test").indexOf.call(h.cookie,"test"))}catch(a){c.$broadcast("LocalStorageModule.notification.error",a.message),u=!1}var t=function(a,b,f){if(A(b))return!1;if(H(b)||v(b))b=B(b);if(!u)return c.$broadcast("LocalStorageModule.notification.error",
"COOKIES_NOT_SUPPORTED"),!1;try{var e="",m=new Date,g="";null===b?(m.setTime(m.getTime()+-864E5),e="; expires="+m.toGMTString(),b=""):G(f)&&0!==f?(m.setTime(m.getTime()+864E5*f),e="; expires="+m.toGMTString()):0!==r.expiry&&(m.setTime(m.getTime()+864E5*r.expiry),e="; expires="+m.toGMTString());if(a){var k="; path="+r.path;r.domain&&(g="; domain="+r.domain);h.cookie=d+a+"="+encodeURIComponent(b)+e+k+g}}catch(l){return c.$broadcast("LocalStorageModule.notification.error",l.message),!1}return!0},C=function(a){if(!u)return c.$broadcast("LocalStorageModule.notification.error",
"COOKIES_NOT_SUPPORTED"),!1;for(var b=h.cookie&&h.cookie.split(";")||[],f=0;f<b.length;f++){for(var e=b[f];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(d+a+"=")){a=decodeURIComponent(e.substring(d.length+a.length+1,e.length));try{return JSON.parse(a)}catch(m){return a}}}return null},x=function(a){t(a,null)},z=function(){for(var a=null,b=d.length,f=h.cookie.split(";"),c=0;c<f.length;c++){for(a=f[c];" "===a.charAt(0);)a=a.substring(1,a.length);a=a.substring(b,a.indexOf("="));x(a)}};
return{isSupported:n,getStorageType:function(){return q},set:y,add:y,get:D,keys:function(){if(!n)return c.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),[];var a=d.length,b=[],f;for(f in l)if(f.substr(0,a)===d)try{b.push(f.substr(a))}catch(e){return c.$broadcast("LocalStorageModule.notification.error",e.Description),[]}return b},remove:E,clearAll:function(a){var b=d?new RegExp("^"+d):RegExp();a=a?new RegExp(a):RegExp();if(!n||"cookie"===k.storageType)return n||
c.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),z();var f=d.length,e;for(e in l)if(b.test(e)&&a.test(e.substr(f)))try{E(e.substr(f))}catch(m){return c.$broadcast("LocalStorageModule.notification.error",m.message),z()}return!0},bind:function(a,b,c,e){e=e||b;var d=D(e);null===d&&F(c)?d=c:v(d)&&v(c)&&(d=I(d,c));g(b).assign(a,d);return a.$watch(b,function(a){y(e,a)},v(a[b]))},deriveKey:function(a){return d+a},length:function(){for(var a=0,b=p[q],c=0;c<b.length;c++)0===
b.key(c).indexOf(d)&&a++;return a},cookie:{isSupported:u,set:t,add:t,get:C,remove:x,clearAll:z}}}]})})(window,window.angular);
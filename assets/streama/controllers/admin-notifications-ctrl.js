//# sourceMappingURL=admin-notifications-ctrl.js.map
angular.module("streama").controller("adminNotificationsCtrl",["$scope","apiService","modalService","$state",function(a,d,c,e){a.loading=!0;a.openNotificationModal=function(){c.notificationAddModal({},function(b){console.log(b);a.notifications.push(b)})};d.notification.list().then(function(b){a.notifications=b.data;a.loading=!1});a.sendCurrentNotifcation=function(){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"Cancel"}});alertify.confirm("Are you sure you want to send all of the open Notifications in the queue?",
function(b){b&&d.notification.sendCurrentNotifcation().then(function(){_.forEach(a.notifications,function(a){a.isCompleted=!0});alertify.success("The notification was sent for "+a.openNotificationAmount()+" entries.")},function(a){alertify.error("There were no open notifications to send.")})})};a.openNotificationAmount=function(){console.log("%c open","color: deeppink; font-weight: bold; text-shadow: 0 0 5px deeppink;",_.filter(a.notifications,"isCompleted"));return _.reject(a.notifications,"isCompleted").length};
a.openMovieModal=function(){c.movieModal(null,function(a){e.go("admin.movie",{movieId:a.id})})};a.delete=function(b){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"Cancel"}});alertify.confirm("Are you sure you want to delete this notification?",function(c){c&&d.notification.delete(b.id).then(function(c){_.remove(a.notifications,{id:b.id})})})}}]);
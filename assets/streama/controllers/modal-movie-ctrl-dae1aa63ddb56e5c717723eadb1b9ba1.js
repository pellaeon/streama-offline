//# sourceMappingURL=modal-movie-ctrl.js.map
angular.module("streama").controller("modalMovieCtrl",["$scope","$uibModalInstance","apiService","movie","$state","uploadService","modalService",function(a,e,c,f,k,g,h){a.loading=!1;a.movie=f||{};a.movieDB=!0;a.hasMovieDBKey=!0;a.addManually=a.movie.id&&!a.movie.apiId;a.chooseNewBackdrop=function(){h.openImageChooser("movie",a.movie)};a.imageUpload={};a.uploadImage=function(b,d){g.doUpload(a.imageUpload,"file/upload.json",function(b){a.imageUpload.percentage=null;b.error||(a.movie[d]=b,a.movie[d+
"_src"]=b.src)},function(){},b)};a.saveMovie=function(a){c.movie.save(a).then(function(a){e.close(a.data);alertify.success("Movie saved.")})};a.toggleAddManually=function(){a.addManually=!a.addManually};a.selectFromAPI=function(b){console.log("%c selectFromAPI","color: deeppink; font-weight: bold; text-shadow: 0 0 5px deeppink;");var d=b.id;delete b.id;a.movie=b;a.movie.apiId=d;a.addManually=!1;a.hasMovieDBKey=!0;a.formVisible=!0};a.search=function(a){return c.theMovieDb.search("movie",a).then(function(a){return a.data})};
a.onTagSelect=function(a){c.tag.save(a)};a.tagTransform=function(a){return{name:a,isNew:!0}};a.deleteTag=function(b){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"Cancel"}});alertify.confirm("Are you sure you want to delete the tag "+b.name,function(d){d&&c.tag.delete(b.id).then(function(){_.remove(a.tags,{id:b.id})})})};a.cancel=function(){e.dismiss("cancel")};(function(){c.genres.list().then(function(b){a.genres=b.data});c.theMovieDb.hasKey().then(function(b){b.data.key||(a.hasMovieDBKey=
!1,a.addManually=!0)});c.tag.list().then(function(b){a.tags=b.data});setTimeout(function(){$(".name-input").focus()},200)})()}]);
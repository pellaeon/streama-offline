//# sourceMappingURL=admin-movie-ctrl.js.map
angular.module("streama").controller("adminMovieCtrl",["$scope","apiService","$stateParams","modalService","$state","uploadService",function(a,d,c,e,f,g){a.loading=!0;a.LoadingSimilar=!0;d.movie.get(c.movieId).then(function(b){a.movie=b.data;a.reportsForMovie();a.loading=!1;a.highlightOnDashboard=e.newReleaseModal.bind(e,a.movie,"movie");a.movie.hasOwnProperty("apiId")?a.loadsimilar():a.LoadingSimilar=!1});a.reportsForMovie=function(){d.report.reportsById(c.movieId).then(function(b){a.movie.reportCount=
b.data.reportCount})};a.loadsimilar=function(){d.movie.getsimilar(c.movieId).then(function(b){a.LoadingSimilar=!1;a.movie.similarMovies=b.data})};a.showDetails=function(b){a.media=b;e.mediaDetailModal({isEditButtonHidden:!0,mediaId:b.id,mediaType:b.mediaType,mediaObject:b,isApiMovie:!0})};a.openMovieModal=function(){e.movieModal(a.movie,function(b){angular.merge(a.movie,b)})};a.delete=function(){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"Cancel"}});alertify.confirm("Are you sure you want to delete this Movie?",
function(a){a&&d.movie.delete(c.movieId).then(function(){f.go("admin.movies")})})};a.addToCurrentNotification=function(){d.notification.addMovieToCurrentNotification(c.movieId).then(function(){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"No"}});alertify.confirm("The movie was added to the current notification queue. Would you like to send it?",function(a){a?(d.notification.sendCurrentNotifcation(),alertify.success("Notification sent.")):alertify.success("The movie was added to the current notification queue.")})})};
a.deleteMovie=function(a){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"Cancel"}});alertify.confirm("Are you sure, you want to delete this Movie?",function(c){c&&d.movie.delete(a.id).then(function(){f.go("admin.movies");$uibModalInstance.dismiss("cancel")})})};a.manageFiles=function(a){e.fileManagerModal(a,function(d){a.hasFiles=!!a.files.length})};a.addSimilarMovieToStreama=function(a,c){alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"Cancel"}});alertify.confirm('Do you want to add "'+
a.title+'" to the Streama library?',function(e){e&&(e=a.id,delete a.id,a.apiId=e,d.movie.save(a).then(function(a){c&&f.go("admin.movie",{movieId:a.data.id})}))})};a.uploadStatus={};a.upload=g.doUpload.bind(g,a.uploadStatus,"video/uploadFile.json?id="+c.movieId,function(b){a.uploadStatus.percentage=null;b.error||(a.movie.files=a.movie.files||[],a.movie.files.push(b))},function(){})}]);
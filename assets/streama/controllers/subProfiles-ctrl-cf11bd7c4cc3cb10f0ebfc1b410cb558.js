//# sourceMappingURL=subProfiles-ctrl.js.map
angular.module("streama").controller("subProfilesCtrl",["$scope","apiService","$rootScope","userService","localStorageService","$state","profileService",function(a,c,e,f,g,h,d){a.profile={profileName:"",profileLanguage:"en",isChild:!1,avatarColor:"0b74b2"};a.standardColor="0b74b2";a.existingProfiles=[];a.loading=!0;a.isManageProfiles=!1;a.isEditProfile=!1;a.isCreateProfile=!1;a.availableColors="0b74b2 ba1c56 099166 d1b805 c03da7 488f16 d36e10 4b4b4b 3a328b b81f1f".split(" ");d.getUserProfiles().then(function(b){a.existingProfiles=
b.data});a.setCurrentProfile=d.setCurrentProfile;a.setProfileColor=function(b){a.profile.avatarColor=b};a.toggleManageProfiles=function(){a.isManageProfiles=!a.isManageProfiles};a.goToEditProfile=function(b){a.isEditProfile=!a.isEditProfile;a.profile=b};a.goToCreateProfile=function(){a.isCreateProfile=!a.isCreateProfile;a.profile={profileName:"",profileLanguage:"en",isChild:!1,avatarColor:"0b74b2"}};a.deleteProfile=function(){1===a.existingProfiles.length?alertify.error("You must have at least ONE profile!"):
a.profile.id===d.getCurrentProfile().id?alertify.error("You currently use this profile! Change profile first"):a.profile.id&&c.profile.delete(a.profile.id).then(function(){alertify.success("Profile Deleted!");a.getAllProfiles();a.loading=!1;a.refreshStates()},function(b){alertify.error(b.message);a.loading=!1})};a.refreshStates=function(){a.isEditProfile=!1;a.isCreateProfile=!1};a.saveProfile=function(){a.profile.profileName&&(a.profile.id?c.profile.update:c.profile.save)(a.profile).then(function(){alertify.success(a.profile.id?
"Profile Updated!":"Profile Created!");a.getAllProfiles();a.loading=!1;e.$broadcast("streama.profiles.onChange")},function(b){alertify.error(b.message);a.loading=!1})};a.getAllProfiles=function(){c.profile.getUserProfiles().then(function(b){a.existingProfiles=b.data;a.refreshStates()},function(b){alertify.error(b.message);a.loading=!1})};a.showPreviewProfiles=function(){return!a.isManageProfiles&&!(a.isEditProfile||a.isCreateProfile)};a.showEditProfiles=function(){return a.isManageProfiles&&!(a.isEditProfile||
a.isCreateProfile)}}]);
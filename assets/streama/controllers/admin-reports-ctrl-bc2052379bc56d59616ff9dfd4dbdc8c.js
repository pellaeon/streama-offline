//# sourceMappingURL=admin-reports-ctrl.js.map
(function(){angular.module("streama").controller("adminReportsCtrl",["apiService","$state","$rootScope","$filter",function(e,k,l,m){function g(c){c&&(a.isResolvedFilter=c,a.pagination.currentPage=1,f=0);h({max:a.maxPerPage,resolved:a.isResolvedFilter,offset:f,sort:a.sortAndOrderBy.sort,order:a.sortAndOrderBy.order})}function h(c){a.reports=[];a.reportsCount=0;e.report.list(c).then(function(b){a.reports=b.data.reports;a.reportsCount=b.data.count},function(){alertify.error("An error occurred.")})}var a=
this,d=[];a.isResolvedFilter="all";a.maxPerPage=15;a.pagination={};a.sortAndOrderBy={sort:"dateCreated",order:"DESC"};var f=0;a.resolveMultiple=function(){0<d.length?(alertify.set({buttonReverse:!0,labels:{ok:"Yes",cancel:"Cancel"}}),alertify.confirm("This will resolve all selected reports. Do you want to proceed?",function(c){c&&e.report.resolveMultiple(d).then(function(b){_.forEach(b.data,function(b){b=_.find(a.reports,{id:b.id});_.set(b,"resolved",!0)});d=[];alertify.success("Selected reports have been resolved.")},
function(){alertify.error("Reports could not be resolved.")})})):alertify.error("No reports selected.")};a.resolve=function(a){e.report.resolve(a.id).then(function(b){b=b.data;a.resolved=b.resolved;a.lastUpdated=b.lastUpdated;alertify.success("Selected report has been resolved.")},function(){alertify.error("Report could not be resolved.")})};a.unresolve=function(a){e.report.unresolve(a.id).then(function(b){b=b.data;a.resolved=b.resolved;a.lastUpdated=b.lastUpdated;alertify.success("Selected report has been unresolved.")},
function(){alertify.error("Report could not be unresolved.")})};a.pageChanged=function(){f=a.maxPerPage*(a.pagination.currentPage-1);h({max:a.maxPerPage,filter:a.listFilter,offset:f,sort:a.sortAndOrderBy.sort,order:a.sortAndOrderBy.order})};a.refreshList=g;a.addOrRemoveFromSelection=function(a,b){a.target.checked&&!1===b.resolved?d.push(b.id):_.remove(d,function(a){return a===b.id})};g()}])})();